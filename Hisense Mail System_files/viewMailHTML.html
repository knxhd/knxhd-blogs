<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Frameset//EN" "http://www.w3.org/TR/html4/frameset.dtd">
<!-- saved from url=(0211)https://xhmail.hisense.com/coremail/XT5/jsp/viewMailHTML.jsp?mid=2%3A1tbiAh8DBl3hzaoD-wAAs-&mailCipherPassword=&partId=&isSearch=&priority=&supportSMIME=&striptTrs=true&mboxa=&iframeId=1699085165663&sspurl=false -->
<html><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
        <title></title>
        <meta http-equiv="Content-Type" content="text/html">
        <link href="./readmail.css" rel="stylesheet" type="text/css" charset="utf-8">
        <script type="text/javascript" src="./jquery-1.8.2.min.js"></script>
    </head>
    <body>
        <div class="topPlaceholder" style="height: 239px;"></div>
        
        <div class="j-mail-content mailContent readContent"><div style="font-size: 16px;  font-family: SimSun;line-height: 1.5"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="compose-quote-zone" class="compose-rows ng-binding" ng-class="showReferencedContent? &#39;&#39; : &#39;&#39;" ng-bind-html="$parent.$parent.quoteContent | trustedHtml" placeholder=""><div class="quoteHtml" style="margin-top:20px;"><div id="compose-quote-zone" class="compose-rows ng-binding" ng-class="showReferencedContent? &#39;&#39; : &#39;&#39;" ng-bind-html="$parent.$parent.quoteContent | trustedHtml" placeholder=""><div class="quoteHtml" style="margin-top:20px;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><p><span style="font-family:&#39;Microsoft YaHei&#39;;">松哥，霞姐好：</span></p><p style="font-family:SimSun;"><span style="font-size:x-small;"><span style="font-family:&#39;Microsoft YaHei&#39;;font-size:16px;">&nbsp;以下是我的这周周报，请注意查收<br></span></span></p><p style="font-family:SimSun;"><span style="font-size:x-small;"><span style="font-family:&#39;Microsoft YaHei&#39;;font-size:16px;"><br></span></span></p><p style="font-family:SimSun;"></p><table border="0" cellpadding="0" cellspacing="0" width="847" height="470" style="width:847.02pt;" class="ke-zeroborder"><colgroup><col width="32" style="width:32.8pt;"><col width="165" style="width:165.2pt;"><col width="532" style="width:532pt;"><col width="57" style="width:57.2pt;"><col width="60" style="width:60.4pt;"></colgroup><tbody><tr height="19" style="height:19.1pt;"><td colspan="5" class="et2" height="19" width="847" x:str="" style="height:19.1pt;width:847.6pt;padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">重点任务</td></tr><tr height="18" style="height:18.35pt;"><td class="et2" height="18" x:str="" style="height:18.35pt;padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">序号</td><td class="et2" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">重点项目/任务</td><td class="et2" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">工作内容</td><td class="et2" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">起止时间</td><td class="et2" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">完成情况</td></tr><tr height="67" style="height:67pt;"><td class="et3" height="67" x:num="1" style="height:67pt;padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;text-align:center;">1</td><td class="et7" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;border-image:initial;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;font-weight:700;border-top:1pt solid #000000;border-bottom:1pt solid #000000;border-left:1pt solid #000000;">&nbsp;大模型接入</td><td class="et8" width="532" x:str="" style="width:532pt;padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;color:#000000;font-size:12pt;border:1px solid #000000;white-space:normal;">1、备忘录大模型微服务开发和中控模块开发，整体链路已调通<br>2、备忘录大模型提示词优化，可稳定输出操作类型、时间信息和内容<br>3、备忘录大模型方案设计文档编写，完成100%</td><td class="et9" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;border-image:initial;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border-top:1pt solid #000000;border-right:1pt solid #000000;border-bottom:1pt solid #000000;">10.23-10.27&nbsp;</td><td class="et6" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;">完成100%</td></tr><tr height="125" style="height:125.5pt;"><td rowspan="2" class="et3" height="142" x:num="2" style="height:142.3pt;padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;text-align:center;">2</td><td rowspan="2" class="et4" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;font-weight:700;border:1pt solid #000000;">【应市】运营管理平台九期</td><td rowspan="2" class="et5" width="532" x:str="" style="width:532pt;padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;border-image:initial;vertical-align:middle;color:#000000;font-size:12pt;border-right:1pt solid #000000;border-left:1pt solid #000000;white-space:normal;">1、运营管理平台同步数据功能开发，完成100%<br></td><td rowspan="2" class="et6" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;">10.24~10.25</td><td rowspan="2" class="et6" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;">完成100%</td></tr><tr height="16" style="height:16.8pt;"></tr><tr height="19" style="height:19.1pt;"><td colspan="5" class="et2" height="19" x:str="" style="height:19.1pt;padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">困难风险与应对措施</td></tr><tr height="19" style="height:19.1pt;"><td class="et3" height="19" x:num="1" style="height:19.1pt;padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;text-align:center;">1</td><td colspan="4" class="et11" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;text-align:left;"> </td></tr><tr height="19" style="height:19.1pt;"><td colspan="5" class="et2" height="19" x:str="" style="height:19.1pt;padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">下周工作计划</td></tr><tr height="19" style="height:19.1pt;"><td rowspan="8" class="et3" height="166" x:num="1" style="height:166.7pt;padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;text-align:center;">1</td><td colspan="4" rowspan="8" class="et12" width="814" x:str="" style="width:814.8pt;padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;border-image:initial;color:#000000;font-size:12pt;font-weight:700;border-top:1pt solid #000000;border-left:1pt solid #000000;text-align:left;vertical-align:top;white-space:normal;">一、大模型接入<br>&nbsp; &nbsp;1、备忘录微服务下发协议对接<br>&nbsp; &nbsp;2、时间解析模块优化论证<br>&nbsp; &nbsp;3、完成备忘录微服务开发<br></td></tr><tr height="19" style="height:19.1pt;"></tr><tr height="36" style="height:36.75pt;"></tr><tr height="18" style="height:18.35pt;"></tr><tr height="18" style="height:18.35pt;"></tr><tr height="18" style="height:18.35pt;"></tr><tr height="18" style="height:18.35pt;"></tr><tr height="18" style="height:18.35pt;"></tr></tbody></table><p></p><p><br></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div ng-bind-html="$parent.$parent.defaultSignatureContent | trustedHtml" class="ng-binding" placeholder="" style="font-family:SimSun;"></div></div></div><div ng-bind-html="$parent.$parent.defaultSignatureContent | trustedHtml" class="ng-binding" placeholder=""></div></div></div></div></div></div>
        <div class="attachPlaceholder" style="height: 90px;"></div>
        

<script type="text/javascript">
    /**
     * ´´½¨È«¾ÖJSON¶ÔÏó£¬°üº¬·½·¨£ºstringifyºÍparse
     *
     * ¼æÈÝIE8(Q)
     *
     * ²Î¿¼[json2.js](https://github.com/douglascrockford/JSON-js)
     */
    ;(function jsonShim(global) {
        if (typeof global.JSON !== 'object') {
            global.JSON = {};
        }

        (function() {
            'use strict';

            function f(n) {
                // Format integers to have at least two digits.
                return n < 10 ? '0' + n : n;
            }

            if (typeof Date.prototype.toJSON !== 'function') {

                Date.prototype.toJSON = function () {

                    return isFinite(this.valueOf()) ?
                    this.getUTCFullYear()     + '-' +
                    f(this.getUTCMonth() + 1) + '-' +
                    f(this.getUTCDate())      + 'T' +
                    f(this.getUTCHours())     + ':' +
                    f(this.getUTCMinutes())   + ':' +
                    f(this.getUTCSeconds())   + 'Z' :
                            null;
                };

                String.prototype.toJSON      =
                        Number.prototype.toJSON  =
                                Boolean.prototype.toJSON = function () {
                                    return this.valueOf();
                                };
            }

            var cx,
                escapable,
                gap,
                indent,
                meta,
                rep;


            function quote(string) {

                // If the string contains no control characters, no quote characters, and no
                // backslash characters, then we can safely slap some quotes around it.
                // Otherwise we must also replace the offending characters with safe escape
                // sequences.

                escapable.lastIndex = 0;
                return escapable.test(string) ? '"' + string.replace(escapable, function (a) {
                    var c = meta[a];
                    return typeof c === 'string'
                            ? c
                            : '\\u' + ('0000' + a.charCodeAt(0).toString(16)).slice(-4);
                }) + '"' : '"' + string + '"';
            }


            function str(key, holder) {

                // Produce a string from holder[key].

                var i,          // The loop counter.
                    k,          // The member key.
                    v,          // The member value.
                    length,
                    mind = gap,
                    partial,
                    value = holder[key];

                // If the value has a toJSON method, call it to obtain a replacement value.

                if (value && typeof value === 'object' &&
                    typeof value.toJSON === 'function') {
                    value = value.toJSON(key);
                }

                // If we were called with a replacer function, then call the replacer to
                // obtain a replacement value.

                if (typeof rep === 'function') {
                    value = rep.call(holder, key, value);
                }

                // What happens next depends on the value's type.

                switch (typeof value) {
                case 'string':
                    return quote(value);

                case 'number':

                    // JSON numbers must be finite. Encode non-finite numbers as null.

                    return isFinite(value) ? String(value) : 'null';

                case 'boolean':
                case 'null':

                    // If the value is a boolean or null, convert it to a string. Note:
                    // typeof null does not produce 'null'. The case is included here in
                    // the remote chance that this gets fixed someday.

                    return String(value);

                        // If the type is 'object', we might be dealing with an object or an array or
                        // null.

                case 'object':

                    // Due to a specification blunder in ECMAScript, typeof null is 'object',
                    // so watch out for that case.

                    if (!value) {
                        return 'null';
                    }

                    // Make an array to hold the partial results of stringifying this object value.

                    gap += indent;
                    partial = [];

                    // Is the value an array?

                    if (Object.prototype.toString.apply(value) === '[object Array]') {

                        // The value is an array. Stringify every element. Use null as a placeholder
                        // for non-JSON values.

                        length = value.length;
                        for (i = 0; i < length; i += 1) {
                            partial[i] = str(i, value) || 'null';
                        }

                        // Join all of the elements together, separated with commas, and wrap them in
                        // brackets.

                        v = partial.length === 0
                                ? '[]'
                                : gap
                                ? '[\n' + gap + partial.join(',\n' + gap) + '\n' + mind + ']'
                                : '[' + partial.join(',') + ']';
                        gap = mind;
                        return v;
                    }

                    // If the replacer is an array, use it to select the members to be stringified.

                    if (rep && typeof rep === 'object') {
                        length = rep.length;
                        for (i = 0; i < length; i += 1) {
                            if (typeof rep[i] === 'string') {
                                k = rep[i];
                                v = str(k, value);
                                if (v) {
                                    partial.push(quote(k) + (gap ? ': ' : ':') + v);
                                }
                            }
                        }
                    } else {

                        // Otherwise, iterate through all of the keys in the object.

                        for (k in value) {
                            if (Object.prototype.hasOwnProperty.call(value, k)) {
                                v = str(k, value);
                                if (v) {
                                    partial.push(quote(k) + (gap ? ': ' : ':') + v);
                                }
                            }
                        }
                    }

                    // Join all of the member texts together, separated with commas,
                    // and wrap them in braces.

                    v = partial.length === 0
                            ? '{}'
                            : gap
                            ? '{\n' + gap + partial.join(',\n' + gap) + '\n' + mind + '}'
                            : '{' + partial.join(',') + '}';
                    gap = mind;
                    return v;
                }
            }

            // If the JSON object does not yet have a stringify method, give it one.

            if (typeof JSON.stringify !== 'function') {
                escapable = /[\\\"\x00-\x1f\x7f-\x9f\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
                meta = {    // table of character substitutions
                    '\b': '\\b',
                    '\t': '\\t',
                    '\n': '\\n',
                    '\f': '\\f',
                    '\r': '\\r',
                    '"' : '\\"',
                    '\\': '\\\\'
                };
                JSON.stringify = function (value, replacer, space) {

                    // The stringify method takes a value and an optional replacer, and an optional
                    // space parameter, and returns a JSON text. The replacer can be a function
                    // that can replace values, or an array of strings that will select the keys.
                    // A default replacer method can be provided. Use of the space parameter can
                    // produce text that is more easily readable.

                    var i;
                    gap = '';
                    indent = '';

                    // If the space parameter is a number, make an indent string containing that
                    // many spaces.

                    if (typeof space === 'number') {
                        for (i = 0; i < space; i += 1) {
                            indent += ' ';
                        }

                        // If the space parameter is a string, it will be used as the indent string.

                    } else if (typeof space === 'string') {
                        indent = space;
                    }

                    // If there is a replacer, it must be a function or an array.
                    // Otherwise, throw an error.

                    rep = replacer;
                    if (replacer && typeof replacer !== 'function' &&
                        (typeof replacer !== 'object' ||
                         typeof replacer.length !== 'number')) {
                        throw new Error('JSON.stringify');
                    }

                    // Make a fake root object containing our value under the key of ''.
                    // Return the result of stringifying the value.

                    return str('', {'': value});
                };
            }

            // If the JSON object does not yet have a parse method, give it one.

            if (typeof JSON.parse !== 'function') {
                cx = /[\u0000\u00ad\u0600-\u0604\u070f\u17b4\u17b5\u200c-\u200f\u2028-\u202f\u2060-\u206f\ufeff\ufff0-\uffff]/g;
                JSON.parse = function (text, reviver) {

                    // The parse method takes a text and an optional reviver function, and returns
                    // a JavaScript value if the text is a valid JSON text.

                    var j;

                    function walk(holder, key) {

                        // The walk method is used to recursively walk the resulting structure so
                        // that modifications can be made.

                        var k, v, value = holder[key];
                        if (value && typeof value === 'object') {
                            for (k in value) {
                                if (Object.prototype.hasOwnProperty.call(value, k)) {
                                    v = walk(value, k);
                                    if (v !== undefined) {
                                        value[k] = v;
                                    } else {
                                        delete value[k];
                                    }
                                }
                            }
                        }
                        return reviver.call(holder, key, value);
                    }


                    // Parsing happens in four stages. In the first stage, we replace certain
                    // Unicode characters with escape sequences. JavaScript handles many characters
                    // incorrectly, either silently deleting them, or treating them as line endings.

                    text = String(text);
                    cx.lastIndex = 0;
                    if (cx.test(text)) {
                        text = text.replace(cx, function (a) {
                            return '\\u' +
                                   ('0000' + a.charCodeAt(0).toString(16)).slice(-4);
                        });
                    }

                    // In the second stage, we run the text against regular expressions that look
                    // for non-JSON patterns. We are especially concerned with '()' and 'new'
                    // because they can cause invocation, and '=' because it can cause mutation.
                    // But just to be safe, we want to reject all unexpected forms.

                    // We split the second stage into 4 regexp operations in order to work around
                    // crippling inefficiencies in IE's and Safari's regexp engines. First we
                    // replace the JSON backslash pairs with '@' (a non-JSON character). Second, we
                    // replace all simple value tokens with ']' characters. Third, we delete all
                    // open brackets that follow a colon or comma or that begin the text. Finally,
                    // we look to see that the remaining characters are only whitespace or ']' or
                    // ',' or ':' or '{' or '}'. If that is so, then the text is safe for eval.

                    if (/^[\],:{}\s]*$/
                                    .test(text.replace(/\\(?:["\\\/bfnrt]|u[0-9a-fA-F]{4})/g, '@')
                                            .replace(/"[^"\\\n\r]*"|true|false|null|-?\d+(?:\.\d*)?(?:[eE][+\-]?\d+)?/g, ']')
                                            .replace(/(?:^|:|,)(?:\s*\[)+/g, ''))) {

                        // In the third stage we use the eval function to compile the text into a
                        // JavaScript structure. The '{' operator is subject to a syntactic ambiguity
                        // in JavaScript: it can begin a block or an object literal. We wrap the text
                        // in parens to eliminate the ambiguity.

                        j = eval('(' + text + ')'); /* eslint no-eval: 0, no-extend-native: 0 */

                        // In the optional fourth stage, we recursively walk the new structure, passing
                        // each name/value pair to a reviver function for possible transformation.

                        return typeof reviver === 'function'
                                ? walk({'': j}, '')
                                : j;
                    }

                    // If the text is not JSON parseable, then a SyntaxError is thrown.

                    throw new SyntaxError('JSON.parse');
                };
            }
        }());
    }(window));
</script>
        <script type="text/javascript">
            var host = location.hostname,
                protocol = location.protocol,
                port = location.port;
            var origin = protocol + '//' + host + (port ? ':' + port : '');
            var isLoad = false;

            var iframeId = '1699085165663';
            var mid = '2:1tbiAh8DBl3hzaoD-wAAs-';
            var isThread = false;
            if (isThread) $('body').css('overflow-y', 'hidden');

            var calcPageHeight = function(doc) {
                var cHeight = Math.max(doc.body.clientHeight, doc.documentElement.clientHeight);
                var sHeight = Math.max(doc.body.scrollHeight, doc.documentElement.scrollHeight);
                return Math.max(cHeight, sHeight);
            };
            var calcBodyHeight = function(doc) {
                var cHeight = Math.min(doc.body.clientHeight, doc.documentElement.clientHeight);
//                console.log(doc.body.clientHeight, doc.documentElement.clientHeight);
                return cHeight;
            };
            var calcPageWidth = function(doc) {
                return Math.max(doc.body.clientWidth, doc.documentElement.clientWidth);
            };

            function doPostMessage(message) {
                if (message == null) {
                    return false;
                }
                if (typeof message !== 'string') {
                    message = JSON.stringify(message);
                }

                parent.postMessage(message, origin);
            }
            doPostMessage.types = {
                ATTACHMENTS_REFER: 'attachmentsRefer',
                SIZE_ADJUST: 'sizeAdjust',
                OPEN_LINK: 'openLink',
                OPEN_SSPURL: 'openSspurl',
                HIDE_MENU: 'hideMenu',
                VIEW_ATTACH: 'viewAttach',
                MAIL_OP: 'mailOp'
            };

            var extractResult = _extractTrsAttachments($('.j-mail-content').html('<div style="font-size: 16px;  font-family: SimSun;line-height: 1.5"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;font-family:SimSun;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div id="compose-quote-zone" class="compose-rows ng-binding" ng-class="showReferencedContent? \'\' : \'\'" ng-bind-html="$parent.$parent.quoteContent | trustedHtml" placeholder=""><div class="quoteHtml" style="margin-top:20px;"><div id="compose-quote-zone" class="compose-rows ng-binding" ng-class="showReferencedContent? \'\' : \'\'" ng-bind-html="$parent.$parent.quoteContent | trustedHtml" placeholder=""><div class="quoteHtml" style="margin-top:20px;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><div style="font-size:16px;line-height:1.5;"><p><span style="font-family:\'Microsoft YaHei\';">松哥，霞姐好：</span></p><p style="font-family:SimSun;"><span style="font-size:x-small;"><span style="font-family:\'Microsoft YaHei\';font-size:16px;">&nbsp;以下是我的这周周报，请注意查收<br></span></span></p><p style="font-family:SimSun;"><span style="font-size:x-small;"><span style="font-family:\'Microsoft YaHei\';font-size:16px;"><br></span></span></p><p style="font-family:SimSun;"></p><table border="0" cellpadding="0" cellspacing="0" width="847" height="470" style="width:847.02pt;" class="ke-zeroborder"><colgroup><col width="32" style="width:32.8pt;"><col width="165" style="width:165.2pt;"><col width="532" style="width:532pt;"><col width="57" style="width:57.2pt;"><col width="60" style="width:60.4pt;"></colgroup><tbody><tr height="19" style="height:19.1pt;"><td colspan="5" class="et2" height="19" width="847" x:str="" style="height:19.1pt;width:847.6pt;padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">重点任务</td></tr><tr height="18" style="height:18.35pt;"><td class="et2" height="18" x:str="" style="height:18.35pt;padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">序号</td><td class="et2" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">重点项目/任务</td><td class="et2" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">工作内容</td><td class="et2" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">起止时间</td><td class="et2" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">完成情况</td></tr><tr height="67" style="height:67pt;"><td class="et3" height="67" x:num="1" style="height:67pt;padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;text-align:center;">1</td><td class="et7" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;border-image:initial;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;font-weight:700;border-top:1pt solid #000000;border-bottom:1pt solid #000000;border-left:1pt solid #000000;">&nbsp;大模型接入</td><td class="et8" width="532" x:str="" style="width:532pt;padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;color:#000000;font-size:12pt;border:1px solid #000000;white-space:normal;">1、备忘录大模型微服务开发和中控模块开发，整体链路已调通<br>2、备忘录大模型提示词优化，可稳定输出操作类型、时间信息和内容<br>3、备忘录大模型方案设计文档编写，完成100%</td><td class="et9" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;border-image:initial;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border-top:1pt solid #000000;border-right:1pt solid #000000;border-bottom:1pt solid #000000;">10.23-10.27&nbsp;</td><td class="et6" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;">完成100%</td></tr><tr height="125" style="height:125.5pt;"><td rowspan="2" class="et3" height="142" x:num="2" style="height:142.3pt;padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;text-align:center;">2</td><td rowspan="2" class="et4" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;font-weight:700;border:1pt solid #000000;">【应市】运营管理平台九期</td><td rowspan="2" class="et5" width="532" x:str="" style="width:532pt;padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;border-image:initial;vertical-align:middle;color:#000000;font-size:12pt;border-right:1pt solid #000000;border-left:1pt solid #000000;white-space:normal;">1、运营管理平台同步数据功能开发，完成100%<br></td><td rowspan="2" class="et6" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;">10.24~10.25</td><td rowspan="2" class="et6" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;">完成100%</td></tr><tr height="16" style="height:16.8pt;"></tr><tr height="19" style="height:19.1pt;"><td colspan="5" class="et2" height="19" x:str="" style="height:19.1pt;padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">困难风险与应对措施</td></tr><tr height="19" style="height:19.1pt;"><td class="et3" height="19" x:num="1" style="height:19.1pt;padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;text-align:center;">1</td><td colspan="4" class="et11" x:str="" style="padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;text-align:left;"> </td></tr><tr height="19" style="height:19.1pt;"><td colspan="5" class="et2" height="19" x:str="" style="height:19.1pt;padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#FFFFFF;font-size:12pt;font-weight:700;border:1pt solid #000000;background:#00AAA6;text-align:center;">下周工作计划</td></tr><tr height="19" style="height:19.1pt;"><td rowspan="8" class="et3" height="166" x:num="1" style="height:166.7pt;padding-top:1px;padding-left:1px;padding-right:1px;font-weight:400;font-style:normal;text-decoration:none;font-family:宋体;vertical-align:middle;white-space:nowrap;color:#000000;font-size:12pt;border:1pt solid #000000;text-align:center;">1</td><td colspan="4" rowspan="8" class="et12" width="814" x:str="" style="width:814.8pt;padding-top:1px;padding-left:1px;padding-right:1px;font-style:normal;text-decoration:none;font-family:宋体;border-image:initial;color:#000000;font-size:12pt;font-weight:700;border-top:1pt solid #000000;border-left:1pt solid #000000;text-align:left;vertical-align:top;white-space:normal;">一、大模型接入<br>&nbsp; &nbsp;1、备忘录微服务下发协议对接<br>&nbsp; &nbsp;2、时间解析模块优化论证<br>&nbsp; &nbsp;3、完成备忘录微服务开发<br></td></tr><tr height="19" style="height:19.1pt;"></tr><tr height="36" style="height:36.75pt;"></tr><tr height="18" style="height:18.35pt;"></tr><tr height="18" style="height:18.35pt;"></tr><tr height="18" style="height:18.35pt;"></tr><tr height="18" style="height:18.35pt;"></tr><tr height="18" style="height:18.35pt;"></tr></tbody></table><p></p><p><br></p></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div></div><div ng-bind-html="$parent.$parent.defaultSignatureContent | trustedHtml" class="ng-binding" placeholder="" style="font-family:SimSun;"></div></div></div><div ng-bind-html="$parent.$parent.defaultSignatureContent | trustedHtml" class="ng-binding" placeholder=""></div></div></div></div></div>'));
            doPostMessage({
                inLineTrsAttachments: extractResult.trsAttachments,
                type: doPostMessage.types.ATTACHMENTS_REFER,
                attachments: [{
'id':'3',
'filename':'田露华_20231027_工作周报.xlsx',
'contentType':'application/vnd.openxmlformats-officedocument.spreadsheetml.sheet',
'contentLength':14778,
'encoding':'base64',
'contentOffset':19435,
'estimateSize':10800}],
                inlineAttachments: [],
                mid: mid,
                iframeId: iframeId
            });

            window.onload = function() {
                var images,
                    tables,
                    bodyHeight,
                    aLinks,
                    widOverflow,
                    i;

                isLoad = true;
                scroll();
                doPostMessage({
                    iframeId: iframeId,
                    isThread: isThread,
                    type: doPostMessage.types.VIEW_ATTACH
                });
                bodyHeight = parseInt(calcPageHeight(document));
                aLinks = document.getElementsByTagName("a");

                for (i = 0; i < aLinks.length; i++) {
                    aLinks[i].onclick = function() {
                        // parent.postMessage('{"openLink":"' + this.href + '"}', origin);
                        doPostMessage({
                            type: doPostMessage.types.OPEN_LINK,
                            href: this.href
                        });
                        return false;
                    }
                }

                

                if (isThread) {
                    doPostMessage({
                        type: doPostMessage.types.SIZE_ADJUST,
                        iHeight: bodyHeight,
                        iScrollTop: 0,
                        iframeId: iframeId,
                        isAutoSize: false,
                        widOverflow : false,
                        isLoad: isLoad,
                        isThread: isThread
                    });
                }

                document.onclick = function() {
                    doPostMessage({
                        type: doPostMessage.types.HIDE_MENU,
                        hideMenu: 'true'
                    });
                    // parent.postMessage('{"hideMenu":"true"}', origin);
                };
                widOverflow = false;
                function resizeImages(bodyWidth) {
                    var images,
                        tables,
                        i;

//                    bodyWidth = calcPageWidth(document) || bodyWidth;
                    images = document.getElementsByTagName("img");
                    tables = document.getElementsByTagName("table");

                    // 进行如下修正:
                    // 1. 超过body宽度的图片进行宽度压缩
                    // 2. 超过body宽度的表格相应增加body的宽度
                    for(i = 0; i < images.length; i++ ) {
                        var originWidth = images[i].getAttribute('data-width');
                        if (!originWidth) {
                            images[i].setAttribute('data-width', images[i].width);
                            originWidth = images[i].width
                        }
                        if (originWidth) {

                            if (originWidth > bodyWidth) {
                                images[i].width = bodyWidth - 20;
                            } else {
                                //reset to default image width
                                images[i].width = originWidth;
                            }
                        }
                    }
                    for (i = 0; i < tables.length; i++) {
                        if (tables[i].clientWidth > bodyWidth) {
                            widOverflow = true;
                            bodyWidth = tables[i].clientWidth + 30;
                        }
                    }
                }
            };
            function reCalBodyHeight(message) {
                // 会话模式下正文高度为0时iframe高度不作调整
                // 避免会话模式下超大附件margin-bottom的15px没有算进来
                if (isThread && $('.mailContent')[0].offsetHeight == 0) return;
                var height = (message.topHeight || 0)+ $('.mailContent')[0].offsetHeight + (isThread ? 15 : 0);
                var scrollTop = $(document).scrollTop();
                $('.topPlaceholder').css('height', message.topHeight || 0);
                $('.attachPlaceholder').css('height', message.attachHeight || 0);
                if (height && message.toBottom && isLoad) window.scrollTo(0, height);
                if (message.resize) {
                    doPostMessage({
                        type: doPostMessage.types.SIZE_ADJUST,
                        iHeight: height,
                        iScrollTop: scrollTop,
                        iframeId: iframeId,
                        isLoad: isLoad,
                        isThread: isThread
                    });
                }
            }

            function scrollBody(x, y) {
                x = x || 0;
                y = y || 0;
                var scrollTop = $(document).scrollTop();
                var scrollLeft = $(document).scrollLeft();
                if (x != 0 || y != 0) {
                    window.scrollTo(scrollLeft + x, scrollTop + y);
                }
            }

            function messageDispatcher (evt) {
                var message = evt.data;
                if (message == null) {
                    return false;
                }
                if (typeof message == 'string') {
                    message = JSON.parse(message);
                }
                if (message.type == 'resize') {
                    reCalBodyHeight(message);
                }
                if (message.type == 'scroll') {
                    scrollBody(message.scrollX, message.scrollY);
                }
            }

            function keydown(evt) {
                var keyCodeMap = {
                    82: 'reply',
                    65: 'replyall',
                    70: 'forward',
                    46: 'delete'
                };
                if (evt.keyCode === 65 || evt.keyCode === 82 || evt.keyCode === 70 || evt.keyCode === 46) {
                    doPostMessage({
                        type: doPostMessage.types.MAIL_OP,
                        mailOp: keyCodeMap[evt.keyCode]
                    });
                    // parent.postMessage('{"mailOp": "' + keyCodeMap[evt.keyCode] + '"}', origin);
                }
            }

            function scroll() {
                if (isThread) return;
                var scrollTop = $(document).scrollTop();
                var bodyHeight = $('.mailContent')[0].offsetHeight;
                var topHeight = $('.topPlaceholder')[0].offsetHeight;
                doPostMessage({
                    type: doPostMessage.types.SIZE_ADJUST,
                    iHeight: bodyHeight + topHeight,
                    iScrollTop: scrollTop,
                    isLoad: isLoad,
                    iframeId: iframeId
                });
            }

            if (window.addEventListener) {
                // For standards-compliant web browsers
                window.addEventListener("message", messageDispatcher, false);
                window.addEventListener("keydown", keydown, false);
                if (!isThread) window.addEventListener('scroll', scroll, false);
            } else {
                window.attachEvent("onmessage", messageDispatcher);
                window.attachEvent("onkeydown", keydown);
                if (!isThread) window.attachEvent('onscroll', scroll);
            }

            function _extractTrsAttachments($ele) {
                var $trsContent = $ele.find('.bigatt_bt');
                var trsAttachments = [];
                $trsContent.each(function () {
                    var $ele = $(this);
                    var $nameWrapper = $ele.find('.name_big');
                    var $name = $nameWrapper.find('> span > a');
                    var sizeAndTimeArray = $nameWrapper.find('> span > span').text().split(',');
                    if (!$name[0] || !sizeAndTimeArray[0] || !sizeAndTimeArray[1]) {
                        return;
                    }
                    $ele.data('needRemove', true);
                    var sizeText = sizeAndTimeArray[0]; // eg: " (6MB"
                    var timeText = sizeAndTimeArray[1]; // eg: " 2019年12月22日 16:16 到期)"
                    var expiryTimeArray = $.grep(timeText.match(/\d*/g), function (str) { return str });
                    var expiryTime = expiryTimeArray[0] + '-' + expiryTimeArray[1] + '-' + expiryTimeArray[2] + ' ' + expiryTimeArray[3] + ':' + expiryTimeArray[4];
                    trsAttachments.push({
                        filename: $name.text(),
                        trsDownloadUrl: $name.attr('href'),
                        formatSize: sizeText.substring(sizeText.match(/\d/).index).replace(/B$/, ''),
                        expiryTime: expiryTime
                    })
                });

                _removeTrs();

                function _removeTrs() {
                    $trsContent.each(function () {
                        $(this).data('needRemove') && $(this).closest('#largeAttachmentsBox').remove();
                    });
                }
                return {
                    trsAttachments: trsAttachments
                };
            }
        </script>
    



</body></html>